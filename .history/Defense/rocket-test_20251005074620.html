<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rocket Defense System Test</title>
    <link rel="stylesheet" href="rocket-test.css" />
    <script src="//cdn.jsdelivr.net/npm/globe.gl"></script>
</head>

<body>
    <!-- Controls Sidebar -->
    <div id="controls">
        <h3>🚀 Rocket Defense System</h3>
        
        <div id="game-status" class="game-status">
            <div class="status-box ready">
                <span class="status-label">Status:</span>
                <span id="status-value">READY</span>
            </div>
        </div>
        
        <div class="game-progress">
            <div class="progress-item">
                <span>Deflection Progress:</span>
                <div class="progress-bar">
                    <div id="deflection-progress" class="progress-fill">0%</div>
                </div>
            </div>
        </div>

        <div class="label">
            🌑 Asteroid Properties
            <span class="info-icon" 
                data-tip="Properties of the incoming asteroid that affect how much rocket power is needed to deflect it."></span>
        </div>
        
        <div class="row">
            <label>Diameter</label>
            <input id="ui-diameter" type="number" min="500" max="5000" step="100" value="2300" />
            <span>m</span>
        </div>

        <div class="row">
            <label>Density</label>
            <input id="ui-density" type="number" min="1000" max="5000" step="50" value="2750" />
            <span>kg/m³</span>
        </div>

        <div class="row">
            <label>Velocity</label>
            <input id="ui-velocity" type="number" min="5" max="50" step="1" value="20" />
            <span>km/s</span>
        </div>

        <div class="row">
            <label>Angle</label>
            <input id="ui-angle" type="number" min="15" max="90" step="5" value="45" />
            <span>°</span>
        </div>

        <button id="simulateBtn" class="primary-btn">🚀 Launch Rocket Defense</button>

        <hr>

        <div class="label">
            🚀 Rocket Controls
            <span class="info-icon" 
                data-tip="Control the rocket missile system to intercept the asteroid."></span>
        </div>
        
        <div class="row">
            <label>Rocket Power</label>
            <input id="rocket-power" type="range" min="10" max="100" step="5" value="50" />
            <span id="rocket-power-out">50%</span>
        </div>
        
        <div class="row">
            <label>Targeting Range</label>
            <input id="rocket-range" type="range" min="0.05" max="0.5" step="0.05" value="0.15" />
            <span id="rocket-range-out">0.15</span>
        </div>

        <div id="rocket-stats" class="rocket-stats">
            <div class="stat-item">
                <span class="stat-label">🎯 Targeting:</span>
                <span class="stat-value" id="targeting-status">READY</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">💥 Impact Force:</span>
                <span class="stat-value" id="force-value">0 N</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">🛰️ Trajectory Change:</span>
                <span class="stat-value" id="deflection-value">0°</span>
            </div>
        </div>

        <button id="fire-rocket" class="action-btn">🚀 FIRE ROCKET</button>
        <button id="reset-simulation" class="secondary-btn" style="display: none;">🔄 Reset Simulation</button>
    </div>
    
    <!-- Game messages display -->
    <div id="game-message" class="game-message">
        Welcome to Rocket Defense System. Configure rocket and press Launch Defense to begin.
    </div>

    <!-- Globe visualization container -->
    <div id="globeViz"></div>
    
    <!-- Time display -->
    <div id="time"></div>

    <!-- Test rocket display area -->
    <div id="rocket-preview" class="rocket-preview">
        <h4>🚀 Rocket Model Preview</h4>
        <div class="model-info">
            <p><strong>Model:</strong> rocket.glb</p>
            <p><strong>Status:</strong> <span id="model-status">Loading...</span></p>
            <p><strong>Scale:</strong> <span id="model-scale">1.0x</span></p>
        </div>
        <div class="preview-controls">
            <button class="preview-btn" onclick="testRocketScale(0.5)">0.5x Scale</button>
            <button class="preview-btn" onclick="testRocketScale(1.0)">1.0x Scale</button>
            <button class="preview-btn" onclick="testRocketScale(2.0)">2.0x Scale</button>
        </div>
    </div>

    <script type="module">
        // Basic rocket test script - just for model loading test
        import { GLTFLoader } from 'https://esm.sh/three/examples/jsm/loaders/GLTFLoader.js';
        
        console.log('🚀 Rocket Defense System Test Loading...');
        
        // Test rocket.glb loading
        const gltfLoader = new GLTFLoader();
        const modelStatus = document.getElementById('model-status');
        
        gltfLoader.load('rocket.glb', 
            (gltf) => {
                console.log('✅ Rocket GLTF loaded successfully:', gltf);
                modelStatus.textContent = 'Loaded Successfully ✅';
                modelStatus.style.color = '#00cc44';
            },
            (progress) => {
                console.log('🔄 Loading progress:', progress);
                modelStatus.textContent = 'Loading... ' + Math.round((progress.loaded / progress.total) * 100) + '%';
            },
            (error) => {
                console.error('❌ Error loading rocket.glb:', error);
                modelStatus.textContent = 'Failed to Load ❌';
                modelStatus.style.color = '#ff4444';
            }
        );
        
        // Test scale functions
        window.testRocketScale = (scale) => {
            console.log('🔧 Testing rocket scale:', scale);
            document.getElementById('model-scale').textContent = scale + 'x';
        };
        
        // Basic UI interactions
        document.getElementById('simulateBtn').addEventListener('click', () => {
            console.log('🚀 Launch Rocket Defense clicked!');
            document.getElementById('game-message').textContent = 'Rocket Defense System Activated! Ready to intercept asteroid.';
        });
        
        document.getElementById('fire-rocket').addEventListener('click', () => {
            console.log('🎯 Fire Rocket clicked!');
            document.getElementById('game-message').textContent = 'Rocket fired! Targeting asteroid for interception.';
        });
        
        // Update rocket power display
        document.getElementById('rocket-power').addEventListener('input', (e) => {
            document.getElementById('rocket-power-out').textContent = e.target.value + '%';
        });
        
        // Update rocket range display
        document.getElementById('rocket-range').addEventListener('input', (e) => {
            document.getElementById('rocket-range-out').textContent = e.target.value;
        });
    </script>
</body>
</html>